"use strict";import x from"object-hash";export async function internalFetch({baseUrl:r,method:u,path:n,params:s,headers:f,body:t}){let a=/^https?:\/\//.test(n)?n:r+n;{const p=new URLSearchParams;for(const[g,c]of Object.entries(s??{})){if(c==null)continue;const m=new RegExp(`:${g}(?=/|$)`,"g");m.test(a)?a=a.replace(m,c.toString()):p.append(g,c.toString())}const h=p.toString();a+=`${h?"?":""}${h}`}const i=t===void 0?!0:typeof t=="object"&&(t===null||t.constructor===Object),o=t===void 0?!1:typeof t=="string",j=t===void 0?!1:t instanceof FormData,e=await fetch(a,{method:u,headers:{"content-type":i?"application/json":o?"text/plain":j?"multipart/form-data":"application/octet-stream",...f},body:t===void 0?void 0:i?JSON.stringify(t):t}),l=e.headers.get("content-type"),w=Object.fromEntries(e.headers.entries());let d;try{d=l?.includes("json")?await e.json():l?.startsWith("text/")?await e.text():await e.arrayBuffer()}catch{d=void 0}return{status:e.status,ok:e.ok,headers:w,data:d,raw:e}}export function getDefaultRespondedAt(r){return new Date(r.headers.date??Date.now()).getTime()}export function getGetterInner(r){return(u,n,s)=>{const f=`GET ${n}`,t=r.config?.routes?.[f];if(!t)return;const i=(t?.hash??x)(s??{}),o=u[n]?.[i];return o!==void 0?o:typeof t.defaultValue=="function"?t.defaultValue(s??{}):t.defaultValue}}
